---
name: excel-generator
description: "專業的 Excel 試算表建立，注重美觀與資料分析。用於建立試算表以組織、分析與呈現結構化資料，格式清晰且專業。"
version: 1.0.0
---

# Excel 生成器技能

> 本技能專注於建立功能強大且外觀專業的 Excel 試算表，支援資料分析、視覺化與自動化。

## 核心能力

- **專業試算表建立**：從零開始或基於模板建立結構清晰的 Excel 檔案 (.xlsx)。
- **資料格式化與樣式**：應用數字格式、字體、顏色、對齊方式和邊框，提升可讀性。
- **公式與計算**：插入複雜的 Excel 公式，執行數學運算、統計分析和邏輯判斷。
- **圖表與視覺化**：根據資料生成各種類型的圖表，如長條圖、折線圖、圓餅圖等。
- **多工作表管理**：在單一 Excel 檔案中建立和管理多個工作表，並在工作表之間建立關聯。
- **資料驗證與條件格式**：設定資料驗證規則以確保資料品質，並使用條件格式突顯重要資訊。
- **進階功能**：支援凍結窗格、設定列印區域、合併儲存格等進階排版功能。

## 使用場景

- **財務報表**：製作標準的資產負債表、損益表和現金流量表。
- **專案管理**：建立甘特圖、任務清單和資源分配表。
- **銷售分析**：生成銷售報告、業績儀表板和客戶資料分析。
- **人力資源**：製作員工名冊、薪資單和績效評估表。
- **學術研究**：整理實驗數據、進行統計分析和繪製圖表。

## 工作流程

1.  **需求分析**：明確試算表的用途、結構、需要的資料欄位和計算邏輯。
2.  **資料準備**：收集並整理需要匯入到 Excel 的原始資料。
3.  **結構設計**：規劃工作表的佈局，包括標題、欄位名稱、資料區域等。
4.  **內容生成**：使用 Python 的 `openpyxl` 或 `xlsxwriter` 套件，將資料寫入儲存格，並應用格式和公式。
5.  **圖表與視覺化**：根據需要插入圖表，並設定其樣式和資料範圍。
6.  **驗證與交付**：檢查生成的 Excel 檔案是否符合預期，然後交付給使用者。

## 範例：建立銷售分析報告

**使用者請求**：
> 「請幫我建立一份銷售分析報告的 Excel 檔案。我會提供一個 CSV 檔案，裡面包含產品、地區、銷售額和日期。我需要在 Excel 中看到：
> 1.  原始資料表。
> 2.  按產品分類的銷售總額摘要表。
> 3.  一個顯示各產品銷售佔比的圓餅圖。」

**AI 代理執行流程**：

1.  **[ASK]** 請提供您的銷售資料 CSV 檔案。
2.  **[INFO]** 收到 `sales_data.csv` 檔案，開始建立 Excel 報告。
3.  **[執行中]** 使用 `pandas` 讀取 CSV 資料。
4.  **[執行中]** 使用 `openpyxl` 建立新的 Excel 檔案，包含三個工作表：「原始資料」、「銷售摘要」、「圖表」。
5.  **[執行中]** 將原始資料寫入「原始資料」工作表，並美化表格樣式。
6.  **[執行中]** 計算各產品的銷售總額，將結果寫入「銷售摘要」工作表。
7.  **[執行中]** 在「圖表」工作表中，根據摘要資料建立一個圓餅圖。
8.  **[RESULT]** 銷售分析報告已建立完成。Excel 檔案包含原始資料、銷售摘要和視覺化圖表。請查看附件。
    -   附件：`sales_analysis_report.xlsx`

## 所需工具

- **Python 套件**：`openpyxl`, `pandas`, `xlsxwriter`

## 注意事項

-   對於非常大的資料集（超過 100 萬行），建議考慮使用更專業的資料分析工具，或分批處理。
-   `openpyxl` 和 `xlsxwriter` 在功能上略有差異，例如 `xlsxwriter` 更適合建立新檔案和圖表，而 `openpyxl` 則能讀取和修改現有檔案。
-   確保生成的 Excel 檔案與使用者期望的 Excel 版本相容。
